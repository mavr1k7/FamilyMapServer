CREATE TABLE `Users` (
	`username`	TEXT NOT NULL UNIQUE,
	`password`	TEXT NOT NULL,
	`email`	TEXT NOT NULL UNIQUE,
	`firstname`	TEXT NOT NULL,
	`lastname`	TEXT NOT NULL,
	`gender`	TEXT NOT NULL CHECK(gender == "f" OR gender == "m"),
	`person_id`	TEXT NOT NULL UNIQUE,
	PRIMARY KEY(`username`),
	FOREIGN KEY(`person_id`) REFERENCES `Persons`(`person_id`)
);

CREATE TABLE `AuthTokens` (
	`token`	TEXT NOT NULL UNIQUE,
	`username`	TEXT NOT NULL,
	PRIMARY KEY(`token`)
);

CREATE TABLE `Persons` (
	`person_id`	TEXT NOT NULL UNIQUE,
	`descendant`	TEXT,
	`firstname`	TEXT NOT NULL,
	`lastname`	TEXT NOT NULL,
	`gender`	TEXT NOT NULL CHECK(gender == "f" OR gender == "m"),
	`father`	TEXT,
	`mother`	TEXT,
	`spouse`	TEXT,
	FOREIGN KEY(`descendant`) REFERENCES `Users`(`username`),
	PRIMARY KEY(`person_id`)
);

CREATE TABLE `Events` (
	`event_id`	TEXT NOT NULL UNIQUE,
	`descendant`	TEXT,
	`person_id`	TEXT NOT NULL,
	`latitude`	REAL NOT NULL,
	`longitute`	REAL NOT NULL,
	`country`	TEXT NOT NULL,
	`city`	TEXT NOT NULL,
	`type`	TEXT NOT NULL CHECK(type == "birth" OR type == "baptism" OR type == "christening" OR type == "marriage" OR type == "death" OR type == "burial"),
	`year`	INTEGER NOT NULL,
	FOREIGN KEY(`descendant`) REFERENCES `Users`(`username`),
	PRIMARY KEY(`event_id`),
	FOREIGN KEY(`person_id`) REFERENCES `Persons`(`person_id`)
);